<?xml version="1.0" encoding="UTF8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.small.fruitandvagetablemallspringboot.dao.CommodityInformationMpper">
    <select id="queryForCommodityInformationById" parameterType="int" resultType="hashMap">
        SELECT ci.*,
               cc.commoditTypeName
        FROM commodity_information ci
                 LEFT JOIN commodity_classify cc ON ci.commodityClassid = cc.id
        where ci.id = #{id}
        order by ci.commodityHot desc;
    </select>

    <select id="queryForCommodityInfoLimit" resultType="hashMap">
        SELECT ci.*,
               cc.commoditTypeName
        FROM commodity_information ci
                 LEFT JOIN commodity_classify cc ON ci.commodityClassid = cc.id
        order by ci.commodityHot desc limit #{start}, #{pageSize};
    </select>

    <select id="queryForCommodityCount" resultType="int">
        select count(1) FROM commodity_information ci
        LEFT JOIN commodity_classify cc ON ci.commodityClassid = cc.id
        <where>
            <if test="null!=commodityClassId and 0!=commodityClassId">
                commodityClassId =#{commodityClassId}
            </if>
            <if test="null!=search and ''!=search">
                and ci.commodityName like #{search};
            </if>
        </where>
    </select>

    <select id="queryForCommodityInfo" resultType="hashMap">
        select ci.*,
               cc.commoditTypeName
        from commodity_information ci left join commodity_classify cc ON ci.commodityClassid = cc.id
        order by ci.commodityHot desc;
    </select>

    <select id="queryForCommodityInfoAndClass" resultType="hashMap">
        SELECT ci.*,
        cc.commoditTypeName
        FROM commodity_information ci
        LEFT JOIN commodity_classify cc ON ci.commodityClassid = cc.id where 1=1
        <if test="null!=commodityClassId and 0!=commodityClassId">
            and cc.id =#{commodityClassId}
        </if>
        <if test="''!=search and null!=search">
            and ci.commodityName like #{search}
        </if>
        order by ci.commodityHot desc
        <if test="null!=start and null!=pageSize">
            limit #{start} ,#{pageSize};
        </if>
    </select>

    <insert id="addCommodityInfo" parameterType="commodityInformation">
        INSERT INTO commodity_information (commodityInformation, commodityName, commodityHot, commodityFreight,
                                           commodityPrice, commodityImage, commodityNumber, commodityClassId)
        VALUES (#{commodityInformation}, #{commodityName}, 0, #{commodityFreight}, #{commodityPrice},
                #{commodityImage}, #{commodityNumber}, #{commodityClassId})
    </insert>

    <update id="updateCommodityInfoById" parameterType="commodityInformation">
        update commodity_information
        <set>
            <if test="''!=commodityInformation and null!=commodityInformation">
                commodityInformation=#{commodityInformation},
            </if>
            <if test="''!=commodityName and null!=commodityName">
                commodityName=#{commodityName},
            </if>
            <if test="''!=commodityHot and null!=commodityHot">
                commodityHot=#{commodityHot},
            </if>
            <if test="''!=commodityFreight and null!=commodityFreight">
                commodityFreight=#{commodityFreight},
            </if>
            <if test="''!=commodityPrice and null!=commodityPrice">
                commodityPrice=#{commodityPrice},
            </if>
            <if test="''!=commodityImage and null!=commodityImage">
                commodityImage=#{commodityImage},
            </if>
            <if test="''!=commodityNumber and null!=commodityNumber">
                commodityNumber=#{commodityNumber},
            </if>
            <if test="''!=commodityClassId and null!=commodityClassId">
                commodityClassId=#{commodityClassId},
            </if>

        </set>
        where id=#{id}
    </update>

    <delete id="deleteCommodityInfoById" parameterType="int">
        delete
        from commodity_information
        where id = #{id}
    </delete>

    <delete id="deleteCommodityInfoBatchById" parameterType="Integer[]">
        delete from commodity_information where id in
        <foreach collection="commodityIds" item="id" separator="," open="(" close=")">
            #{id}
        </foreach>
    </delete>
</mapper>